<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NumberSense Tutor â€” v4</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div id="sessionOverlay" class="overlay" aria-modal="true" role="dialog">
    <div class="overlay-card">
      <h1>NumberSense</h1>
      <p style="color:var(--text-muted)">Welcome back! Choose how you want to work today.</p>
      <div class="overlay-actions">
        <button id="continueSessionBtn">Continue Last Session</button>
        <button id="newSessionBtn" class="secondary">Start New Session</button>
      </div>
    </div>
  </div>

  <div class="app" aria-hidden="true" id="appShell">
    <header>
      <h1 id="title">NumberSense</h1>
      <div class="sub">Math Practice & Decomposition</div>
    </header>

    <div class="card" aria-labelledby="title">
      <div class="controls">
        <div>
          <label for="modeSelect">Mode</label>
          <select id="modeSelect" aria-label="Practice mode">
            <option value="flash">Flash Cards</option>
            <option value="visual">Visual (Ten-Frame)</option>
            <option value="word">Word Problems</option>
            <option value="decompose">Decomposition</option>
            <option value="shortcut_make10">Strategy: Make 10</option>
          </select>
        </div>

        <div>
          <label for="opSelect">Operation</label>
          <select id="opSelect" aria-label="Operation">
            <option value="mix">Mixed (+ / -)</option>
            <option value="add">Addition</option>
            <option value="sub">Subtraction</option>
            <option value="div">Division</option>
          </select>
        </div>

        <div>
          <label for="maxNumber">Max Number</label>
          <input id="maxNumber" type="number" value="20" min="5" max="100" />
        </div>

        <div>
           <label>&nbsp;</label> <button id="hintBtn" type="button" title="Get a Hint (H)">ðŸ’¡ Show Hint</button>
        </div>
      </div>

      <div class="problem-container">
        <div id="problemArea" class="big-problem">â€”</div>
        <div id="visualArea" aria-hidden="true"></div>
      </div>

      <form id="answerForm" class="answer-row">
        <input
          id="answerInput"
          type="text"
          inputmode="numeric"
          pattern="[0-9, +]*"
          placeholder="Answer..."
          autocomplete="off"
          aria-label="Your answer"
        />
        <button id="checkBtn" type="submit">Check</button>
        <div id="timer" class="timer">0s</div>
      </form>

      <div id="feedback" class="feedback" aria-live="assertive"></div>
      <div id="hintText" class="hint" aria-live="polite"></div>

      <div style="display:flex; justify-content:center; gap:10px; margin-top:20px;">
          <button id="nextBtn" type="button" title="Skip / New Problem (N)">New Problem âž¡</button>
          <button id="resetStats" class="secondary" type="button" style="font-size:0.8rem">Reset Data</button>
       </div>
    </div>

    <div class="card">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
        <h3 style="margin:0; font-size:1.1rem;">Session Progress</h3>
        <button id="downloadSessionBtn" class="secondary" type="button" style="padding:6px 12px; font-size:0.8rem;">
          Download CSV
        </button>
      </div>

      <div class="stats-container">
        <div class="stat-card">
          <div class="stat-label">Correct</div>
          <div class="stat-value" id="statCorrect">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Attempts</div>
          <div class="stat-value" id="statAttempted">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Avg Time</div>
          <div class="stat-value"><span id="statAvgTime">0</span>s</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Streak</div>
          <div class="stat-value" id="statStreak">0</div>
        </div>
      </div>

      <div class="history-wrap">
        <table class="history-table" aria-label="Problem history">
          <thead>
            <tr>
              <th>Problem</th>
              <th>Answer</th>
              <th>Status</th>
              <th>Time</th>
              <th>Hint</th>
            </tr>
          </thead>
          <tbody id="historyBody">
            </tbody>
        </table>
      </div>

      <div style="text-align:center; font-size:0.85rem; color:var(--text-muted); margin-top:15px;">
        <span class="kbd">Enter</span> to check â€¢ <span class="kbd">N</span> for new problem â€¢ <span class="kbd">H</span> for hint
      </div>
    </div>
  </div>

  <script src="app.js" defer></script>
</body>
</html>
